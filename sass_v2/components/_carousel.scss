// ============================================
// ANTSAND Styles v2 - Carousel Component
// Universal structure with parent class variants
// Internal classes remain the same across all variants
// ============================================

// Universal Carousel Structure (works for ALL variants)
// ============================================

[data-carousel] {
  position: relative;
  width: 100%;

  // Header Section (optional)
  .carousel-header {
    margin-bottom: 1.5rem;

    .carousel-title {
      font-size: 1.75rem;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 0.5rem;
    }

    .carousel-description {
      font-size: 1rem;
      color: #718096;
      line-height: 1.6;
    }
  }

  // Body Section (main carousel)
  .carousel-body {
    position: relative;

    .carousel-track-wrapper {
      position: relative;
      overflow: hidden;
      border-radius: 0.75rem;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .carousel-item {
      min-width: 100%;
      flex-shrink: 0;
      position: relative;

      .carousel-item-image {
        position: relative;
        overflow: hidden;

        img {
          width: 100%;
          height: auto;
          display: block;
        }
      }

      .carousel-item-caption {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 2rem;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
        color: white;

        .carousel-item-title {
          font-size: 1.5rem;
          font-weight: 600;
          margin-bottom: 0.5rem;
          color: white;
        }

        .carousel-item-description {
          font-size: 1rem;
          color: #eee;
          margin-bottom: 1rem;
          line-height: 1.6;
        }

        .carousel-item-cta {
          display: inline-block;
          padding: 0.75rem 1.5rem;
          background: white;
          color: #2d3748;
          text-decoration: none;
          border-radius: 0.5rem;
          font-weight: 500;
          transition: all 0.3s ease;

          &:hover {
            background: #f7fafc;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          }
        }
      }
    }
  }

  // Footer Section (controls + indicators)
  .carousel-footer {
    margin-top: 1.5rem;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;

    .carousel-controls {
      display: flex;
      gap: 0.5rem;

      .carousel-control-prev,
      .carousel-control-next {
        width: 3rem;
        height: 3rem;
        border-radius: 50%;
        border: none;
        background: #2d3748;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        line-height: 1;

        &:hover {
          background: #1a202c;
          transform: scale(1.1);
        }

        &:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          transform: scale(1);
        }
      }
    }

    .carousel-indicators {
      display: flex;
      gap: 0.5rem;

      .carousel-indicator {
        width: 0.75rem;
        height: 0.75rem;
        border-radius: 50%;
        background: #cbd5e0;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        padding: 0;

        &:hover {
          background: #a0aec0;
        }

        &.active {
          background: #667eea;
          width: 2rem;
          border-radius: 0.375rem;
        }
      }
    }
  }
}

// ============================================
// Slide Variant (Default)
// Parent class: antsand-carousel-slide
// ============================================
.antsand-carousel-slide {
  .carousel-body {
    .carousel-track-wrapper {
      background: #000;
    }
  }
}

// ============================================
// Fade Variant
// Parent class: antsand-carousel-fade
// ============================================
.antsand-carousel-fade {
  .carousel-body {
    .carousel-track {
      transition: none;
    }

    .carousel-item {
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;

      &.active {
        opacity: 1;
        position: relative;
      }
    }
  }
}

// ============================================
// Cards Variant (Multiple Visible)
// Parent class: antsand-carousel-cards
// ============================================
.antsand-carousel-cards {
  .carousel-body {
    .carousel-track {
      gap: 1rem;
      padding: 0.5rem;
    }

    .carousel-item {
      min-width: calc(33.333% - 0.667rem);
      border-radius: 0.75rem;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;

      &:hover {
        transform: translateY(-0.5rem);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      }

      .carousel-item-caption {
        position: relative;
        background: #f7fafc;
        color: #2d3748;
        padding: 1.25rem;
        background: linear-gradient(to top, #f7fafc, #f7fafc);

        .carousel-item-title {
          color: #2d3748;
        }

        .carousel-item-description {
          color: #718096;
        }

        .carousel-item-cta {
          background: #667eea;
          color: white;

          &:hover {
            background: #5a67d8;
          }
        }
      }
    }
  }
}

// ============================================
// Cover Variant (Full-screen Hero)
// Parent class: antsand-carousel-cover
// ============================================
.antsand-carousel-cover {
  .carousel-body {
    .carousel-item {
      height: 37.5rem; // 600px
      display: flex;
      align-items: center;
      justify-content: center;

      .carousel-item-image img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .carousel-item-caption {
        position: relative;
        text-align: center;
        background: rgba(0, 0, 0, 0.6);
        padding: 3rem;
        border-radius: 1rem;
        backdrop-filter: blur(10px);
        max-width: 43.75rem; // 700px
        background: linear-gradient(
          135deg,
          rgba(0, 0, 0, 0.7),
          rgba(0, 0, 0, 0.5)
        );

        .carousel-item-title {
          font-size: 2.625rem; // 42px
          margin-bottom: 1rem;
        }

        .carousel-item-description {
          font-size: 1.25rem;
          margin-bottom: 1.5rem;
        }
      }
    }
  }
}

// ============================================
// Mobile Responsive (applies to all variants)
// ============================================
@media (max-width: 768px) {
  [data-carousel] {
    .carousel-header {
      .carousel-title {
        font-size: 1.5rem;
      }

      .carousel-description {
        font-size: 0.875rem;
      }
    }

    .carousel-body {
      .carousel-item {
        .carousel-item-caption {
          padding: 1rem;

          .carousel-item-title {
            font-size: 1.25rem;
          }

          .carousel-item-description {
            font-size: 0.875rem;
          }
        }
      }
    }

    .carousel-footer {
      flex-direction: column;
      gap: 1rem;

      .carousel-controls {
        order: 2;
      }

      .carousel-indicators {
        order: 1;
      }
    }
  }

  // Cards become single column on mobile
  .antsand-carousel-cards {
    .carousel-body {
      .carousel-item {
        min-width: 100%;
      }
    }
  }

  // Cover variant smaller on mobile
  .antsand-carousel-cover {
    .carousel-body {
      .carousel-item {
        height: 25rem; // 400px

        .carousel-item-caption {
          padding: 1.5rem;

          .carousel-item-title {
            font-size: 1.75rem;
          }

          .carousel-item-description {
            font-size: 1rem;
          }
        }
      }
    }
  }
}

// ============================================
// Utility Classes
// ============================================

// Hide controls on small screens
@media (max-width: 640px) {
  [data-carousel] {
    .carousel-controls {
      display: none;
    }
  }
}

// Loading state
[data-carousel][data-loading="true"] {
  .carousel-body {
    opacity: 0.5;
    pointer-events: none;
  }
}

// Auto-play indicator
[data-carousel][data-autoplay="true"] {
  .carousel-indicator.active {
    animation: carousel-progress 5s linear;
  }
}

@keyframes carousel-progress {
  from {
    background: #cbd5e0;
  }
  to {
    background: #667eea;
  }
}

// ============================================
// Universal Carousel Feature
// Activates carousel mode on any template via data attributes:
// - data-feature="carousel"        : Primary (auto-populated by volt from CSS config)
// - data-carousel="true"           : Explicit flag
// - data-carousel-variant="cards"  : Optional variant (cards, fade, cover)
// - data-section-index="{n}"       : Section identifier for targeting
//
// Legacy class support: feature-carousel-{n}
// Structure: data-container > data-track > data-sub-container (items)
// ============================================

// ============================================
// LAYOUT-CAROUSEL CLASS (auto-added by volt)
// ============================================
// When carousel feature is enabled, volt adds:
// - .layout-carousel (base)
// - .layout-carousel-cards (variant)
// - .layout-carousel-fade (variant)
// This provides clean CSS without !important overrides

.layout-carousel {
  position: relative;
  display: block !important; // Override any grid/flex from parent selectors

  // Track wrapper provides the overflow clipping
  // This allows the track to transform inside while being clipped
  .data-track-wrapper,
  .carousel-track-wrapper {
    position: relative;
    overflow: hidden;
    width: 100%; // Ensure wrapper takes full width of container

    // Controls should be positioned within the track wrapper (over images)
    .carousel-controls {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1rem;
      pointer-events: none;
      z-index: 10;

      .carousel-control-prev,
      .carousel-control-next {
        width: 3rem;
        height: 3rem;
        border-radius: 50%;
        border: none;
        background: rgba(45, 55, 72, 0.85);
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
        pointer-events: auto;
        backdrop-filter: blur(4px);

        &:hover {
          background: rgba(26, 32, 44, 0.95);
          transform: scale(1.1);
        }
      }
    }
  }

  // The data-track is the sliding container - transforms for sliding
  // Gap can be controlled via:
  // 1. data-track-gap="32" on data-track element (JS applies it)
  // 2. data-carousel-gap="32" on container (JS applies it)
  // 3. CSS gap property (fallback)
  .data-track,
  [data-track] {
    display: flex;
    flex-wrap: nowrap;
    transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    will-change: transform;
    // Default gap - can be overridden by data attributes or inline styles
    gap: 0;

    // Each child of data-track becomes a carousel item
    > * {
      min-width: 100%;
      flex: 0 0 100%;
      flex-shrink: 0;
      opacity: 1;
      transition: opacity 0.3s ease;
    }
  }


  // Also support .carousel-item class directly
  .carousel-item {
    min-width: 100%;
    flex: 0 0 100%;
    flex-shrink: 0;
    opacity: 1;
    transition: opacity 0.3s ease;
  }

  // Carousel Indicators - positioned below the carousel (outside overflow area)
  .carousel-indicators {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 0;
    margin-top: 0.5rem;
    position: relative;
    z-index: 5;

    .carousel-indicator {
      width: 0.75rem;
      height: 0.75rem;
      border-radius: 50%;
      background: #cbd5e0;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      padding: 0;

      &:hover {
        background: #a0aec0;
      }

      &.active {
        background: #667eea;
        width: 2rem;
        border-radius: 0.375rem;
      }
    }

    // Brand red variant (shivasnotes)
    &.carousel-indicators-brand,
    &.carousel-indicators-red {
      .carousel-indicator {
        &:hover {
          background: #e8a090;
        }

        &.active {
          background: #c74a22;
        }
      }
    }
  }

  // Parent-level brand variant - add .carousel-brand to the carousel container
  &.carousel-brand,
  &.carousel-red {
    .carousel-indicators .carousel-indicator {
      &:hover {
        background: #e8a090;
      }

      &.active {
        background: #c74a22;
      }
    }
  }
}

// Support for gap on data-track
.layout-carousel {
  .data-track[style*="gap"],
  [data-track][style*="gap"] {
    // When gap is set inline, items need to account for it
    > * {
      // Flex basis will be calculated by JS based on gap
    }
  }
}

// Cards variant - shows multiple items (3 visible on desktop)
.layout-carousel-cards {
  overflow: visible;

  .data-track,
  [data-track] {
    gap: 1.5rem;

    > .data-sub-container,
    > .carousel-item,
    > * {
      min-width: calc(33.333% - 16px);
      flex: 0 0 calc(33.333% - 16px);
      border-radius: 0.75rem;
      overflow: hidden;

      @media (max-width: 768px) {
        min-width: 100%;
        flex: 0 0 100%;
      }

      @media (min-width: 769px) and (max-width: 1024px) {
        min-width: calc(50% - 12px);
        flex: 0 0 calc(50% - 12px);
      }
    }
  }
}

// Fade variant - crossfade transition
.layout-carousel-fade {
  .data-track,
  [data-track] {
    position: relative;
  }

  .carousel-item,
  > .data-track > * {
    position: absolute;
    top: 0;
    left: 0;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;

    &.active {
      opacity: 1;
      position: relative;
    }
  }
}

// Cover variant - full width hero style
.layout-carousel-cover {
  .data-track,
  [data-track] {
    > * {
      min-height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;

      // Image should cover the entire slide
      img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 0;
      }

      // Content wrapper should be above image
      .data-content-wrapper,
      .content-wrapper {
        position: relative;
        z-index: 1;
        text-align: center;
        padding: 2rem;
        max-width: 800px;
        color: white;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }
    }
  }

  // Overlay for better text readability
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.5));
    z-index: 1;
    pointer-events: none;
  }

  .carousel-controls {
    z-index: 15;
  }

  .carousel-indicators {
    position: absolute;
    bottom: 1.5rem;
    left: 0;
    right: 0;
    z-index: 15;
    margin-top: 0;

    .carousel-indicator {
      background: rgba(255, 255, 255, 0.5);

      &.active {
        background: white;
      }
    }
  }
}

// ============================================
// LEGACY SUPPORT - data attributes & classes
// ============================================
// Keep these for backward compatibility with old implementations
[data-feature="carousel"],
[data-carousel="true"],
[class*="feature-carousel-"] {
  @extend .layout-carousel;
}

[data-carousel-variant="cards"],
.carousel-cards {
  @extend .layout-carousel-cards;
}

[data-carousel-variant="fade"],
.carousel-fade {
  @extend .layout-carousel-fade;
}

[data-carousel-variant="cover"],
.carousel-cover {
  @extend .layout-carousel-cover;
}

// ============================================
// Mobile Responsive
// ============================================
@media (max-width: 640px) {
  .layout-carousel {
    .carousel-controls {
      padding: 0 0.5rem;

      .carousel-control-prev,
      .carousel-control-next {
        width: 2.5rem;
        height: 2.5rem;
        font-size: 1.25rem;
      }
    }

    .carousel-indicators {
      margin-top: 0.5rem;
      padding: 0.5rem 0;
    }
  }
}
